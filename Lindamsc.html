<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SDG6reproducibility</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Lindamsc_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lindamsc_files/libs/quarto-html/quarto.js"></script>
<script src="Lindamsc_files/libs/quarto-html/popper.min.js"></script>
<script src="Lindamsc_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lindamsc_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lindamsc_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lindamsc_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lindamsc_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lindamsc_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lindamsc_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SDG6reproducibility</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="model-1" class="level1">
<h1>Model 1</h1>
<p>Some text</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</section>
<section id="model-2" class="level1">
<h1>Model 2</h1>
</section>
<section id="data-import" class="level1">
<h1>Data import</h1>
<div class="cell">

</div>
</section>
<section id="data-exploration" class="level1">
<h1>Data exploration</h1>
<section id="data-exploration-1" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration-1">Data exploration</h2>
<p>Text</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 58 × 3
   var_short   var_long                                   n
   &lt;chr&gt;       &lt;chr&gt;                                  &lt;int&gt;
 1 s_imp_n     Improved                                 280
 2 s_imp_r     Improved                                1655
 3 s_imp_u     Improved                                1675
 4 s_lat_con_n Latrines: contained                        2
 5 s_lat_con_r Latrines: contained                        2
 6 s_lat_con_u Latrines: contained                        2
 7 s_lat_dtp_n Latrines: delivered to treatment plant     2
 8 s_lat_ebo_n Latrines: emptied and buried onsite       17
 9 s_lat_ebo_r Latrines: emptied and buried onsite       15
10 s_lat_ebo_u Latrines: emptied and buried onsite       11
# … with 48 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="jmp-methods-report" class="level2">
<h2 class="anchored" data-anchor-id="jmp-methods-report">JMP Methods report</h2>
<ul>
<li></li>
</ul>
</section>
</section>
<section id="first-linear-model" class="level1">
<h1>First linear model</h1>
<ul>
<li>Model for Uganda, rural, improved</li>
<li>Data is not linear</li>
</ul>
<section id="observations" class="level2">
<h2 class="anchored" data-anchor-id="observations">Observations</h2>
<p>Learn more about modeling in R:</p>
<ul>
<li>R4DS chapter - https://r4ds.had.co.nz/model-intro.html</li>
<li>Book: Statistical Inference via Data Science: A ModernDive into R and the Tidyverse! - https://moderndive.com/</li>
<li>R Packages: Tidymodels - https://www.tidymodels.org/</li>
</ul>
<p>https://broom.tidymodels.org/articles/broom.html</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>jmpraw <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#filter(iso3 == "SEN") |&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(iso3, var_short, residence) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mutate(mean = mean(value))</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#summarise(mean(value))</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd =</span> <span class="fu">sd</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,681 × 5
# Groups:   iso3, var_short [2,681]
   iso3  var_short     residence  mean     sd
   &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
 1 ABW   s_imp_n       national  98.0   0.458
 2 ABW   s_lat_n       national   1.61  0.424
 3 ABW   s_od_n        national   1.23  0.249
 4 ABW   s_sep_n       national  85.8   4.83 
 5 ABW   s_sew_n       national  10.6   5.72 
 6 ABW   s_treat_wtp_n national  95    NA    
 7 AFG   s_imp_r       rural     35.0   8.36 
 8 AFG   s_imp_u       urban     67.6  13.6  
 9 AFG   s_lat_r       rural     34.5   9.01 
10 AFG   s_lat_u       urban     43.1   6.20 
# … with 2,671 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="reference-papers" class="level2">
<h2 class="anchored" data-anchor-id="reference-papers">Reference papers</h2>
<ul>
<li>LINK</li>
</ul>
<p><strong>Gaps identified</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
    year mean_value
   &lt;dbl&gt;      &lt;dbl&gt;
 1  2000       19.9
 2  2001       19.9
 3  2002       21.6
 4  2003       19.6
 5  2005       28.7
 6  2006       21.8
 7  2009       23.4
 8  2010       26.2
 9  2011       25.5
10  2012       24.0
11  2014       26.8
12  2015       29.2
13  2016       23.0
14  2017       23.1</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By filtering the data for Uganda and improved sanitation, we can see from the graph above that the relationship between year and the stimates is approximately linear and so we will go ahead and fit a linear regression model. The variance(distance from pints to the line) also seems constant and ence homoskedasticity is attained.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mean_value ~ year, data = uga_rural_improved)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2784 -1.4396 -0.6382  1.2948  6.0041 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -592.5279   256.9216  -2.306   0.0397 *
year           0.3068     0.1279   2.399   0.0336 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.687 on 12 degrees of freedom
Multiple R-squared:  0.3241,    Adjusted R-squared:  0.2678 
F-statistic: 5.754 on 1 and 12 DF,  p-value: 0.03359</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-592.53</td>
<td style="text-align: right;">256.92</td>
<td style="text-align: right;">-2.31</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">0.03</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">5.75</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-32.62</td>
<td style="text-align: right;">71.25</td>
<td style="text-align: right;">73.16</td>
<td style="text-align: right;">86.62</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>using the linear model to predict from 2000-2020</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 2
    year  pred
   &lt;dbl&gt; &lt;dbl&gt;
 1  2000  21.1
 2  2001  21.4
 3  2002  21.7
 4  2003  22.0
 5  2004  22.3
 6  2005  22.6
 7  2006  23.0
 8  2007  23.3
 9  2008  23.6
10  2009  23.9
# … with 11 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="fitted-values" class="level1">
<h1>Fitted values</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-diagnostics" class="level1">
<h1>Model diagnostics</h1>
<p>Ater fitting a model, it’s necessary to check the model to see if the model satisfies the assumptions of linear regression. If the model does not fit the data well (for example, the relationship is nonlinear), then you cannot use and interpret the model.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The first graph plots the relationship between the residuals and fitted values. A linear relationship is demonstrate by a horizontal red line.</p>
<p>The scale- location plot analyzes the homogeneity of the variance. We are also looking for a horizontal red line in this case.In this dataset, there is some evidence of homogeneity with points being equally far from the regression line across the observations. #The QQ plot above helps to assess the normality of residuals. Normally distributed residuals will fall along the grey dotted line as is our case above except for a few outliers</p>
<p>To assess whether or not outliers are driving our results we look at the residuals vs leverage plot. Standardized residuals greater than 3 or less than -3 are to be considered as outliers. In our dataset above, we do not see any values in that range (by looking at the y-axis), suggesting that there are no extreme outliers driving the results of our analysis.</p>
</section>
<section id="histogram-plotting-residuals" class="level1">
<h1>Histogram plotting residuals</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="join-input-with-predictions" class="level1">
<h1>Join input with predictions</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 3
    year  pred mean_value
   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1  2000  21.1       19.9
 2  2001  21.4       19.9
 3  2002  21.7       21.6
 4  2003  22.0       19.6
 5  2004  22.3       NA  
 6  2005  22.6       28.7
 7  2006  23.0       21.8
 8  2007  23.3       NA  
 9  2008  23.6       NA  
10  2009  23.9       23.4
# … with 11 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="trying-to-fit-a-generalized-additive-model-since-the-r-squared-in-ols-is-low" class="level1">
<h1>Trying to fit a generalized additive model since the R-SQUARED in OLS is low</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
mean_value ~ year

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -592.5279   256.9216  -2.306   0.0397 *
year           0.3068     0.1279   2.399   0.0336 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


R-sq.(adj) =  0.268   Deviance explained = 32.4%
GCV = 8.4215  Scale est. = 7.2184    n = 14</code></pre>
</div>
</div>
<p>The r squared using the GAM is almost similar to the r squared using OLS regression</p>
</section>
<section id="fitting-polynomial-of-order-4" class="level1">
<h1>Fitting polynomial of order 4</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mean_value ~ poly(year, 4), data = uga_rural_improved)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8763 -1.6102 -0.1530  0.8295  5.3705 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     23.7650     0.7061  33.658 8.89e-11 ***
poly(year, 4)1   6.4448     2.6419   2.439   0.0374 *  
poly(year, 4)2  -4.2971     2.6419  -1.627   0.1383    
poly(year, 4)3  -0.9165     2.6419  -0.347   0.7366    
poly(year, 4)4  -2.1213     2.6419  -0.803   0.4427    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.642 on 9 degrees of freedom
Multiple R-squared:  0.5098,    Adjusted R-squared:  0.292 
F-statistic:  2.34 on 4 and 9 DF,  p-value: 0.1331</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">23.77</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">33.66</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">poly(year, 4)1</td>
<td style="text-align: right;">6.44</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">poly(year, 4)2</td>
<td style="text-align: right;">-4.30</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">-1.63</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">poly(year, 4)3</td>
<td style="text-align: right;">-0.92</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">poly(year, 4)4</td>
<td style="text-align: right;">-2.12</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">0.44</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-30.37</td>
<td style="text-align: right;">72.75</td>
<td style="text-align: right;">76.58</td>
<td style="text-align: right;">62.82</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="adding-a-polynomial-term-significantly-improves-the-r-squared" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-polynomial-term-significantly-improves-the-r-squared">Adding a polynomial term significantly improves the r squared</h2>
</section>
<section id="predictions-using-a-polynomial-term-of-order-4" class="level2">
<h2 class="anchored" data-anchor-id="predictions-using-a-polynomial-term-of-order-4">Predictions using a polynomial term of order 4</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 2
    year  pred
   &lt;dbl&gt; &lt;dbl&gt;
 1  2000  18.9
 2  2001  20.6
 3  2002  21.8
 4  2003  22.5
 5  2004  23.0
 6  2005  23.3
 7  2006  23.5
 8  2007  23.8
 9  2008  24.2
10  2009  24.6
# … with 11 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="plot" class="level2">
<h2 class="anchored" data-anchor-id="plot">plot</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="fitting-a-spline" class="level1">
<h1>Fitting a spline</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mean_value ~ bs(year, knots = c(2003, 2010)), data = uga_rural_improved)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9031 -1.6647  0.1055  0.8146  4.2707 

Coefficients:
                                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                       20.0339     2.5664   7.806 5.21e-05 ***
bs(year, knots = c(2003, 2010))1  -1.9650     4.6073  -0.427   0.6810    
bs(year, knots = c(2003, 2010))2   7.5350     4.8380   1.557   0.1580    
bs(year, knots = c(2003, 2010))3   0.4179     5.5910   0.075   0.9423    
bs(year, knots = c(2003, 2010))4  10.5240     4.6241   2.276   0.0524 .  
bs(year, knots = c(2003, 2010))5   2.5066     3.5174   0.713   0.4963    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.615 on 8 degrees of freedom
Multiple R-squared:  0.5732,    Adjusted R-squared:  0.3065 
F-statistic: 2.149 on 5 and 8 DF,  p-value: 0.1606</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 47%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">20.03</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">7.81</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">bs(year, knots = c(2003, 2010))1</td>
<td style="text-align: right;">-1.97</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bs(year, knots = c(2003, 2010))2</td>
<td style="text-align: right;">7.54</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">bs(year, knots = c(2003, 2010))3</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">5.59</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bs(year, knots = c(2003, 2010))4</td>
<td style="text-align: right;">10.52</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">bs(year, knots = c(2003, 2010))5</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">3.52</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.50</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">-29.4</td>
<td style="text-align: right;">72.81</td>
<td style="text-align: right;">77.28</td>
<td style="text-align: right;">54.69</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="predictions-using-splines" class="level2">
<h2 class="anchored" data-anchor-id="predictions-using-splines">Predictions using splines</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 2
    year  pred
   &lt;dbl&gt; &lt;dbl&gt;
 1  2000  20.0
 2  2001  19.4
 3  2002  20.7
 4  2003  22.5
 5  2004  23.8
 6  2005  24.4
 7  2006  24.5
 8  2007  24.4
 9  2008  24.3
10  2009  24.2
# … with 11 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="plot-using-splines" class="level2">
<h2 class="anchored" data-anchor-id="plot-using-splines">plot using splines</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="model-predictions-all-countries" class="level1">
<h1>Model predictions all countries</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,549 × 9
   source type    year var_short value iso3  var_long residence san_service_ch…¹
   &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;fct&gt;           
 1 MICS03 Survey  2003 s_imp_r    26   AFG   Improved rural     user interface  
 2 NRVA03 Survey  2003 s_imp_r    28.6 AFG   Improved rural     user interface  
 3 NRVS05 Survey  2005 s_imp_r    31.2 AFG   Improved rural     user interface  
 4 NRVA08 Survey  2008 s_imp_r    30.1 AFG   Improved rural     user interface  
 5 MICS11 Survey  2011 s_imp_r    44.2 AFG   Improved rural     user interface  
 6 NRVA12 Survey  2012 s_imp_r    36.3 AFG   Improved rural     user interface  
 7 ALCS14 Survey  2014 s_imp_r    27   AFG   Improved rural     user interface  
 8 DHS15  Survey  2015 s_imp_r    48.0 AFG   Improved rural     user interface  
 9 ALCS17 Survey  2017 s_imp_r    43.8 AFG   Improved rural     user interface  
10 MICS03 Survey  2003 s_imp_u    44.2 AFG   Improved urban     user interface  
# … with 4,539 more rows, and abbreviated variable name ¹​san_service_chain
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="create-a-tidy-dataframe-with-model-intercept-and-coefficient" class="level1">
<h1>Create a tidy dataframe with model intercept and coefficient</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 657 × 4
# Groups:   iso3, residence, var_long [657]
   iso3  residence var_long      rsq
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
 1 AFG   rural     Improved 0.411   
 2 AFG   rural     Shared   0.000291
 3 AFG   urban     Improved 0.832   
 4 AFG   urban     Shared   0.0303  
 5 AGO   rural     Improved 0.981   
 6 AGO   rural     Shared   0       
 7 AGO   urban     Improved 0.658   
 8 AGO   urban     Shared   0       
 9 AIA   urban     Improved 0.882   
10 AIA   urban     Shared   0       
# … with 647 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 657 × 15
# Groups:   iso3, residence, var_long [657]
   iso3  reside…¹ var_l…² r.squ…³ adj.r…⁴   sigma statis…⁵  p.value    df logLik
   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 AFG   rural    Improv… 4.11e-1   0.313   6.92   4.19e+0  8.66e-2     1 -25.7 
 2 AFG   rural    Shared  2.91e-4  -0.250   5.88   1.16e-3  9.74e-1     1 -17.9 
 3 AFG   urban    Improv… 8.32e-1   0.804   6.00   2.98e+1  1.58e-3     1 -24.5 
 4 AFG   urban    Shared  3.03e-2  -0.212  11.7    1.25e-1  7.41e-1     1 -22.0 
 5 AGO   rural    Improv… 9.81e-1   0.976   0.984  2.03e+2  1.40e-4     1  -7.20
 6 AGO   rural    Shared  0         0     NaN     NA       NA          NA Inf   
 7 AGO   urban    Improv… 6.58e-1   0.573   5.91   7.70e+0  5.01e-2     1 -18.0 
 8 AGO   urban    Shared  0         0     NaN     NA       NA          NA Inf   
 9 AIA   urban    Improv… 8.82e-1   0.823   1.05   1.49e+1  6.09e-2     1  -4.49
10 AIA   urban    Shared  0         0     NaN     NA       NA          NA Inf   
# … with 647 more rows, 5 more variables: AIC &lt;dbl&gt;, BIC &lt;dbl&gt;, deviance &lt;dbl&gt;,
#   df.residual &lt;int&gt;, nobs &lt;int&gt;, and abbreviated variable names ¹​residence,
#   ²​var_long, ³​r.squared, ⁴​adj.r.squared, ⁵​statistic
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,314 × 8
# Groups:   iso3, residence, var_long [657]
   iso3  residence var_long term          estimate std.error statistic  p.value
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 AFG   rural     Improved (Intercept) -2150.     1068.       -2.01   0.0908  
 2 AFG   rural     Improved year            1.09      0.531     2.05   0.0866  
 3 AFG   rural     Shared   (Intercept)    70.5    1661.        0.0425 0.968   
 4 AFG   rural     Shared   year           -0.0281    0.825    -0.0341 0.974   
 5 AFG   urban     Improved (Intercept) -4981.      925.       -5.38   0.00169 
 6 AFG   urban     Improved year            2.51      0.460     5.45   0.00158 
 7 AFG   urban     Shared   (Intercept)  1195.     3300.        0.362  0.735   
 8 AFG   urban     Shared   year           -0.580     1.64     -0.354  0.741   
 9 AGO   rural     Improved (Intercept) -2334.      165.      -14.1    0.000145
10 AGO   rural     Improved year            1.17      0.0822   14.3    0.000140
# … with 1,304 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="model-diagnostics-1" class="level1">
<h1>Model diagnostics</h1>
<div class="cell">

</div>
</section>
<section id="display-only-coefficients" class="level1">
<h1>Display only coefficients</h1>
<div class="cell">

</div>
</section>
<section id="adding-predictedfitted-values-to-the-model" class="level1">
<h1>Adding predicted/fitted values to the model</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13,797 × 5
# Groups:   iso3, residence, var_long [657]
   iso3  residence var_long  year .fitted
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 AFG   rural     Improved  2000    24.4
 2 AFG   rural     Improved  2001    25.5
 3 AFG   rural     Improved  2002    26.6
 4 AFG   rural     Improved  2003    27.7
 5 AFG   rural     Improved  2004    28.8
 6 AFG   rural     Improved  2005    29.9
 7 AFG   rural     Improved  2006    31.0
 8 AFG   rural     Improved  2007    32.1
 9 AFG   rural     Improved  2008    33.1
10 AFG   rural     Improved  2009    34.2
# … with 13,787 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,810 × 10
# Groups:   iso3, residence, var_long [657]
   iso3  residence var_long mean_va…¹  year  .resid  .hat .sigma .cooksd .std.…²
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 AFG   rural     Improved     27.3   2003  -0.424 0.467   7.58 0.00309 -0.0839
 2 AFG   rural     Improved     31.2   2005   1.30  0.311   7.55 0.0115   0.226 
 3 AFG   rural     Improved     30.1   2008  -3.04  0.166   7.44 0.0229  -0.481 
 4 AFG   rural     Improved     44.2   2011   7.80  0.126   6.60 0.104    1.20  
 5 AFG   rural     Improved     36.3   2012  -1.14  0.136   7.56 0.00246 -0.177 
 6 AFG   rural     Improved     27     2014 -12.7   0.192   4.22 0.492   -2.03  
 7 AFG   rural     Improved     48.0   2015   7.30  0.238   6.60 0.227    1.21  
 8 AFG   rural     Improved     43.8   2017   0.866 0.364   7.57 0.00705  0.157 
 9 AFG   rural     Shared       16.7   2008   2.67  0.626   6.31 0.463    0.744 
10 AFG   rural     Shared        6.35  2011  -7.59  0.233   4.59 0.329   -1.47  
# … with 3,800 more rows, and abbreviated variable names ¹​mean_value,
#   ²​.std.resid
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="join-input-with-predictions-1" class="level1">
<h1>Join input with predictions</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13,797 × 6
# Groups:   iso3, residence, var_long [657]
   iso3  residence var_long  year .fitted mean_value
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
 1 AFG   rural     Improved  2000    24.4       NA  
 2 AFG   rural     Improved  2001    25.5       NA  
 3 AFG   rural     Improved  2002    26.6       NA  
 4 AFG   rural     Improved  2003    27.7       27.3
 5 AFG   rural     Improved  2004    28.8       NA  
 6 AFG   rural     Improved  2005    29.9       31.2
 7 AFG   rural     Improved  2006    31.0       NA  
 8 AFG   rural     Improved  2007    32.1       NA  
 9 AFG   rural     Improved  2008    33.1       30.1
10 AFG   rural     Improved  2009    34.2       NA  
# … with 13,787 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="plot-predicted-vs-actual-values" class="level1">
<h1>plot predicted vs actual values</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lindamsc_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="spread-data" class="level1">
<h1>Spread data</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,266 × 5
# Groups:   iso3, residence [346]
   iso3  residence  year Improved Shared
   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 AFG   rural      2000     24.4   14.3
 2 AFG   rural      2001     25.5   14.2
 3 AFG   rural      2002     26.6   14.2
 4 AFG   rural      2003     27.7   14.2
 5 AFG   rural      2004     28.8   14.1
 6 AFG   rural      2005     29.9   14.1
 7 AFG   rural      2006     31.0   14.1
 8 AFG   rural      2007     32.1   14.1
 9 AFG   rural      2008     33.1   14.0
10 AFG   rural      2009     34.2   14.0
# … with 7,256 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>